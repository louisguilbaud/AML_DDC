
<!DOCTYPE html>
<html>
    <script src='./javascripts/sas/util/messagingUtil.js'></script>
	<script src="./javascripts/jquery/jquery.min.js"></script>
<head>
    <title>API Call Example</title>
</head>
<body>
    <div>
        <p>URL:     <span id="urlText"></span></p>
        <p>API Key:     <span id="api_key"></span></p>
        <button type="submit" class="btn-primary" id="callApiButton">Call API</button>
        <p>API Response: <span id="apiResponse"></span></p>
    </div>

    <script>
	const llmAPIUrl2 = "https://fsi-openai.openai.azure.com/openai/deployments/network-generation/completions?api-version=2023-09-15-preview"; 
	const maxDocLength2 = 5000; /* You need to adjust this param based on how fast and memory rich your backend server is. Longer the document, more GPU and memory is required. */
	const maxTokens2 = 1000;

        "use strict";

        va.messagingUtil.setOnDataReceivedCallback(updateURL);

        function updateURL(vaMsgObj) {
            console.log(vaMsgObj.data[0][0]);
            if (vaMsgObj && vaMsgObj.data && vaMsgObj.data.length > 0) {
                document.getElementById("urlText").textContent = vaMsgObj.data[0][0];
                document.getElementById("api_key").textContent = vaMsgObj.data[0][1];
            } else {
                document.getElementById("urlText").textContent = "No URL available";
            }
        }

        document.getElementById("callApiButton").addEventListener("click", function() {
            // Get API key from the span element
            var apiKey = document.getElementById("api_key").textContent;

            // Construct API call
            var apiUrl = "https://fsi-openai.openai.azure.com/openai/deployments/network-generation/completions?api-version=2023-09-15-preview";
            var prompt = "hello, how are you?";
		var model = "text-davinci-002";

            // Make API call
            fetch(apiUrl, {
				"prompt": "hello, how are you?"
				"temperature": 0,
				"top_p": 1,
				"frequency_penalty": 2,
				"presence_penalty": 0,
				"max_tokens": maxTokens2,
				"stop": null
			},
			{responseType: 'json',
						headers: {
							'Content-Type': 'application/json;charset=utf-8',
							'Accept': 'application/json',
							'Access-Control-Allow-Origin': '*',
							'api-key': azureAIKey2
						}})
            .then(response => response.json())
            .then(data => {
                document.getElementById("apiResponse").textContent = JSON.stringify(data);
            })
            .catch(error => {
                console.error("Error:", error);
                document.getElementById("apiResponse").textContent = "Error occurred while fetching API data.";
            });
        });
    </script>
</body>
</html>
